webpackJsonp([3],{"/acC":function(t,e,a){"use strict";var i=a("M+K7"),s=a("Qjo9"),r=a("WyEh"),l=a("zHTQ"),n=a("qQ+w"),o=a("KI+6"),c=a("qorP"),p={name:"auditLog",props:{totalLogs:{type:Number,default:0},logs:{type:Array,default:[]},themeType:{type:String,default:"white-theme"},targetType:{type:Number,default:0},targetID:{type:String,default:""},q:{type:String,default:""}},directives:{clipboard:o.a},components:{apiDefine:s.a,retry:l.a,bwlist:r.a,traffic:n.a},data:function(){return{tempApi:{},apiViewVisible:!1,strategy:{content:{}},bwVisible:!1,retryVisble:!1,trafficVisible:!1}},methods:{showStrategy:function(t){switch(this.strategy=JSON.parse(t),this.strategy.content=JSON.parse(this.strategy.content),this.strategy.type){case 1:this.bwVisible=!0;break;case 2:this.retryVisble=!0;break;case 3:this.trafficVisible=!0}},isBlackTheme:function(){return"black-theme"==this.themeType},viewApi:function(t){this.tempApi=JSON.parse(t),this.apiViewVisible=!0},handleCopy:function(t,e){Object(c.a)(t,e),this.$message({message:"Copied",type:"success",duration:2e3})},loadLogs:function(t){var e=this,a={target_app:"juzManage",target_path:"/manage/auditLog/load",target_type:this.targetType,target_id:this.targetID,q:this.q,page:t};Object(i.a)("POST",a).then(function(t){e.logs=t.data.data})}},created:function(){},mounted:function(){},destroyed:function(){}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"black-theme":t.isBlackTheme(),"audit-log":!0}},[a("div",{staticClass:"table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.logs,fit:"","highlight-current-row":"","default-sort":{prop:"modify_date",order:"descending"}}},[a("el-table-column",{attrs:{align:"left",label:"Create Date",width:"160",prop:"modify_date"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.modify_date))])]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"100",align:"left",label:"Target Type"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.target_type?a("span",[t._v("Service")]):2==e.row.target_type?a("span",[t._v("API")]):3==e.row.target_type?a("span",[t._v("Strategy")]):5==e.row.target_type?a("span",[t._v("Batch Setting")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"250",align:"left",label:"Target Name(ID)"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.target_id))])]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"150",align:"left",label:"Content"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.target_type?a("span",[""!=e.row.content?a("span",[t._v(t._s(e.row.content))]):a("span",[t._v("null")])]):t._e(),t._v(" "),4==e.row.target_type?a("span",[t._v(t._s(e.row.content))]):t._e(),t._v(" "),3==e.row.target_type?a("span",[a("i",{staticClass:"el-icon-view hover-cursor icon-primary",staticStyle:{"margin-left":"8px"},on:{click:function(a){t.showStrategy(e.row.content)}}})]):t._e(),t._v(" "),2==e.row.target_type?a("span",[""!=e.row.content?a("i",{staticClass:"el-icon-view hover-cursor icon-primary",staticStyle:{"margin-left":"8px"},on:{click:function(a){t.viewApi(e.row.content)}}}):t._e()]):t._e(),t._v(" "),5==e.row.target_type?a("span",[a("el-popover",{attrs:{placement:"top",width:"800",trigger:"click"}},[t._v("\n                  "+t._s(JSON.parse(e.row.content))+"\n                  "),a("i",{staticClass:"el-icon-view hover-cursor icon-primary",staticStyle:{"margin-left":"8px"},attrs:{slot:"reference"},slot:"reference"})])],1):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"150",align:"left",label:"Service"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.service))])]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"150",align:"left",label:"Operate Type"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.op_type?a("span",[t._v("Create")]):2==e.row.op_type?a("span",[t._v("Edit")]):3==e.row.op_type?a("span",[t._v("Release")]):4==e.row.op_type?a("span",[t._v("Offline")]):5==e.row.op_type?a("span",[t._v("Delete")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"200",align:"left",label:"Operator",prop:"user_id"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.user_id))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"Manage","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[""!=e.row.content?a("span",{staticClass:"table-op-btn",on:{click:function(a){t.handleCopy(e.row.content,a)}}},[t._v("CopyConfig")]):t._e()]}}])})],1),t._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.totalLogs>0,expression:"totalLogs>0"}],attrs:{layout:"total,prev, pager, next",total:t.totalLogs},on:{"current-change":t.loadLogs}})],1),t._v(" "),a("el-dialog",{staticClass:"mf-dialog",attrs:{title:"API Define",visible:t.apiViewVisible,top:"20px"},on:{"update:visible":function(e){t.apiViewVisible=e}}},[a("apiDefine",{attrs:{api:t.tempApi}}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.apiViewVisible=!1}}},[t._v("Close")])],1)],1),t._v(" "),a("el-dialog",{staticClass:"mf-dialog",attrs:{title:"White/Black List",visible:t.bwVisible,top:"20px"},on:{"update:visible":function(e){t.bwVisible=e}}},[a("bwlist",{attrs:{strategy:t.strategy}}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.bwVisible=!1}}},[t._v("Close")])],1)],1),t._v(" "),a("el-dialog",{staticClass:"mf-dialog",attrs:{title:"Timout/Retry",visible:t.retryVisble,top:"20px"},on:{"update:visible":function(e){t.retryVisble=e}}},[a("retry",{attrs:{strategy:t.strategy}}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.retryVisble=!1}}},[t._v("Close")])],1)],1),t._v(" "),a("el-dialog",{staticClass:"mf-dialog",attrs:{title:"Traffic Control",visible:t.trafficVisible,top:"20px"},on:{"update:visible":function(e){t.trafficVisible=e}}},[a("traffic",{attrs:{strategy:t.strategy}}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.trafficVisible=!1}}},[t._v("Close")])],1)],1)],1)},staticRenderFns:[]},m=a("VU/8")(p,u,!1,null,null,null);e.a=m.exports},"00Oy":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"",""])},"9bBU":function(t,e,a){a("mClu");var i=a("FeBl").Object;t.exports=function(t,e,a){return i.defineProperty(t,e,a)}},C4MV:function(t,e,a){t.exports={default:a("9bBU"),__esModule:!0}},EkxJ:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"",""])},GfrX:function(t,e,a){var i=a("WWAb");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("ecce70ca",i,!0)},IeAN:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,s=a("bOdI"),r=a.n(s),l=a("woOf"),n=a.n(l),o=a("mvHQ"),c=a.n(o),p=a("cAgV"),u=a("M+K7"),m=a("vLgD"),f=a("Qjo9"),d={name:"apiTest",props:{api:{type:Object,default:{}}},data:function(){return{tfeAddr:"",testResult:"",testPass:"",testParams:{},debugOn:!1}},watch:{api:function(){this.initTest()}},methods:{calcResult:function(){return""==this.testResult?"":c()(JSON.parse(this.testResult),null,"\t")},handleDebug:function(){this.debugOn?this.$set(this.testParams,"debug_on",!0):this.$set(this.testParams,"debug_on",void 0)},paramEnter:function(t){try{var e=JSON.parse(t);this.testParams=e,this.testParams.debug_on?this.debugOn=!0:this.debugOn=!1;var a={target_app:"juzManage",target_path:"/manage/api/saveParam",api_id:this.api.api_id,params:t};Object(u.a)("POST",a).then(function(t){})}catch(t){this.$message({message:"Params json invalid",type:"error",duration:5e3,center:!0})}},showName:function(t){return t.substring(0,t.length-3)},showVersion:function(t){return t[t.length-1]},startTest:function(){var t=this;this.testResult="",this.testPass="",Object(m.a)({url:"/tools/testApi",method:"POST",params:{tfe_addr:"http://47.91.140.160:8081/service/api",params:this.testParams}}).then(function(e){200==e.data.status?(t.$message({message:"测试成功",type:"success",duration:5e3,center:!0}),t.testResult=e.data.data,t.testPass="true"):(t.$message({message:"测试失败,http code:"+e.data.status,type:"warning",duration:5e3,center:!0}),t.testResult=e.data.message,t.testPass="false")})},makeParam:function(t){return c()(t,null,"\t")},initTest:function(){var t=this;this.testParams={},this.tfeAddr="http://47.91.140.160:8081/service/api",this.testResult="",this.testPass="",this.testParams.api_name=this.showName(this.api.api_id),this.testParams.api_version=this.showVersion(this.api.api_id);var e={target_app:"juzManage",target_path:"/manage/api/queryParam",api_id:this.api.api_id};Object(u.a)("GET",e).then(function(e){console.log(e.data.data),""!=e.data.data&&(t.testParams=JSON.parse(e.data.data),t.testParams.debug_on&&(t.debugOn=!0))})}},mounted:function(){this.initTest()},destroyed:function(){}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"api-test"},[a("el-form",{ref:"dataForm",staticClass:"black-form",attrs:{"label-position":"left","label-width":"130px"}},[a("el-form-item",{attrs:{label:"API ID"}},[t._v("\n          "+t._s(t.api.api_id)+"\n      ")]),t._v(" "),a("el-form-item",{attrs:{label:"Backend Info"}},[1==t.api.backend_type?a("span",[t._v("HTTP(S)-")]):a("span",[t._v("Mock-")]),t._v(" "),1==t.api.addr_type?a("span",[t._v("URL-")]):a("span",[t._v("ETCD-")]),t._v("\n          "+t._s(t.api.backend_addr)+"\n          "),2==t.api.addr_type?a("span",[t._v("-"+t._s(t.api.backend_uri))]):t._e()]),t._v(" "),a("el-form-item",{attrs:{label:"Debug Mode"}},[a("el-radio-group",{on:{change:t.handleDebug},model:{value:t.debugOn,callback:function(e){t.debugOn=e},expression:"debugOn"}},[a("el-radio",{staticStyle:{color:"white"},attrs:{label:!0}},[t._v("ON")]),t._v(" "),a("el-radio",{staticStyle:{color:"white"},attrs:{label:!1}},[t._v("OFF")])],1)],1),t._v(" "),a("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"Params"}},[a("el-input",{staticStyle:{"margin-top":"10px"},attrs:{type:"textarea",autosize:{minRows:10,maxRows:12},value:t.makeParam(t.testParams)},on:{change:t.paramEnter}}),t._v(" "),a("el-alert",{staticStyle:{"margin-top":"8px"},attrs:{title:"Form params only, e.g. http://test.com/service/api?api_name=test&api_version=1",closable:!1,type:"warning"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"800px"},attrs:{label:"Output"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:10,maxRows:50},placeholder:"Test Result",value:t.calcResult(),disabled:!0}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"success"},on:{click:function(e){t.startTest()}}},[t._v("Start")])],1)],1)],1)},staticRenderFns:[]},_=a("VU/8")(d,v,!1,null,null,null).exports,h=a("WyEh"),g=a("zHTQ"),y=a("qQ+w"),b=a("/acC"),w=a("KI+6"),S=a("qorP"),x={name:"api",directives:{waves:p.a},components:{apiDefine:f.a,apiTest:_,auditLog:b.a,bwlist:h.a,retry:g.a,traffic:y.a,clipboard:w.a,clip:S.a},data:function(){return{services:[],selectedService:"",apis:[],totalApis:0,currentPage:1,tempApi:{route_type:"1"},apiDefineVisible:!1,defineStatus:"create",testApi:{},selbwType:1,switchActive:1,switchInactive:0,veryfyVisible:!1,ruleContent:"",tempVerifyRule:{},apiDefineStep:0,apiManageVisible:!1,selectManageIndex:1,apiTitle:"",strategies:[],selBW:"",selRetry:"",selTraffic:"",strategy:{content:{}},totalLogs:0,logs:[],q:"",batchStrategyVisible:!1,batchBW:"",batchRetry:"",batchTraffic:"",selectApis:[],apps:[],tempService:"",tempApps:[]}},methods:(i={handleTempService:function(t){var e=this;this.tempService=t,""!=t?Object(m.a)({url:"/ops/app/query",method:"GET",params:{service:t}}).then(function(t){e.tempApps=t.data.data}):this.tempApps=[]},apiGrafanaAddr:function(t){return"http://47.91.140.160:3000/d/1ZLGyLtiz/tfe-api?refresh=5s&orgId=1&var-api_id="+t},genAPIIDByType:function(){return 0==this.tempApi.path_type?this.tempApi.service+"."+this.tempApi.api_id+".v"+this.tempApi.version:this.tempApi.api_id+".v"+this.tempApi.version},apiNameAlert:function(){return 0==this.tempApi.path_type?"API ID is auto generated with this rule: Service + API Name + 'v' + Version, e.g. test.get.v1":"API ID is auto generated with this rule: API Name + 'v' + VersionAPI ID,e.g. /a/b/c.v1"},apiNameTooltip:function(){return 0==this.tempApi.path_type?"The api name must be the form of a.b, sperated with '.', only allow alphabet and numberic":"The api name must be the form of /a/b,only allow alphabet and numberic"},showName:function(t){return t.substring(0,t.length-3)},showVersion:function(t){return t[t.length-1]},batchRelease:function(){var t=this;0!=this.selectApis.length?this.$confirm("Are you sure to batch release the selected apis?","Warning",{dangerouslyUseHTMLString:!0,cancelButtonText:"Cancel",confirmButtonText:"Submit",type:"info"}).then(function(){for(var e=[],a=0;a<t.selectApis.length;a++)e.push(t.selectApis[a].api_id);var i={target_app:"juzManage",target_path:"/manage/api/batchRelease",api_ids:c()(e)};Object(u.a)("POST",i).then(function(e){t.loadApis(t.currentPage),t.$message({message:"Batch release successfully",type:"success",duration:5e3,center:!0})})}):this.$message({message:"No apis being selected",type:"warning",duration:3e3,center:!0})},batchDelStrategy:function(t){var e=this;this.$confirm("Are you sure to batch delete the strategy?","Warning",{dangerouslyUseHTMLString:!0,cancelButtonText:"Cancel",confirmButtonText:"Submit",type:"info"}).then(function(){for(var a=[],i=0;i<e.selectApis.length;i++)a.push(e.selectApis[i].api_id);var s={target_app:"juzManage",target_path:"/manage/api/batchDelStrategy",api_ids:c()(a),type:t,service:e.selectedService};Object(u.a)("POST",s).then(function(t){e.loadApis(e.currentPage),e.$message({message:"Batch delete successfully",type:"success",duration:3e3,center:!0}),e.batchStrategyVisible=!1})})},submitBatchStrategy:function(){var t=this;""!=this.batchBW||""!=this.batchRetry||""!=this.batchTraffic?this.$confirm("Batch setting will overide the api's specific setting,want to continue?","Warning",{dangerouslyUseHTMLString:!0,cancelButtonText:"Cancel",confirmButtonText:"Submit",type:"info"}).then(function(){for(var e=[],a=0;a<t.selectApis.length;a++)e.push(t.selectApis[a].api_id);var i={target_app:"juzManage",target_path:"/manage/api/batchStrategy",api_ids:c()(e),batch_bw:t.batchBW,batch_retry:t.batchRetry,batch_traffic:t.batchTraffic,service:t.selectedService};Object(u.a)("POST",i).then(function(e){t.loadApis(t.currentPage),t.$message({message:"Batch strategy successfully",type:"success",duration:3e3,center:!0}),t.batchStrategyVisible=!1})}):this.$message({message:"No strategy being selected",type:"warning",duration:3e3,center:!0})},handleBatchStrategy:function(){0!=this.selectApis.length?this.batchStrategyVisible=!0:this.$message({message:"No apis being selected",type:"warning",duration:3e3,center:!0})},selTableRows:function(t){this.selectApis=t}},r()(i,"showName",function(t){return t.substring(0,t.length-3)}),r()(i,"showVersion",function(t){return t[t.length-1]}),r()(i,"handleCopy",function(t,e){var a=c()(t);Object(S.a)(a,e),this.$message({message:"Copied",type:"success",duration:2e3})}),r()(i,"getStrategy",function(t){var e=this;if(""!=t){var a={target_app:"juzManage",target_path:"/manage/strategy/query",id:t};Object(u.a)("POST",a).then(function(t){e.strategy=t.data.data,e.strategy.content=JSON.parse(e.strategy.content)})}else this.$message({message:"No strategy being selected",type:"warning",duration:3e3,center:!0})}),r()(i,"calcRelease",function(t){return t.release_version==t.revise_version?"success":"warning"}),r()(i,"selectBW",function(t){this.tempApi.bw_strategy=""==t?0:t,this.selBW=t}),r()(i,"selectRetry",function(t){this.tempApi.retry_strategy=""==t?0:t,this.selRetry=t}),r()(i,"selectTraffic",function(t){this.tempApi.traffic_strategy=""==t?0:t,this.selTraffic=t}),r()(i,"filterStrategies",function(t){for(var e=[],a=0;a<this.strategies.length;a++)this.strategies[a].type==t&&e.push(this.strategies[a]);return e}),r()(i,"strategyName",function(t){if(0!=t)for(var e=0;e<this.strategies.length;e++)if(this.strategies[e].id==t)return this.strategies[e].name}),r()(i,"offlineAPI",function(t){var e=this;this.$confirm("You will offline this api："+t.api_id+"\n,when offlined, clients will not access this api anymore","Warning",{dangerouslyUseHTMLString:!0,cancelButtonText:"Cancel",confirmButtonText:"Submit",type:"info"}).then(function(){var a={target_app:"juzManage",target_path:"/manage/api/offline",api_id:t.api_id};Object(u.a)("POST",a).then(function(a){t.release_version="",e.$message({message:"Offline successfully",type:"success",duration:5e3,center:!0})})})}),r()(i,"releaseAPI",function(t){var e=this;this.$confirm("You will release this api："+t.api_id,"Warning",{dangerouslyUseHTMLString:!0,cancelButtonText:"Cancel",confirmButtonText:"Submit",type:"info"}).then(function(){var a={target_app:"juzManage",target_path:"/manage/api/release",api_id:t.api_id};Object(u.a)("POST",a).then(function(a){t.release_version=t.revise_version,e.loadApis(e.currentPage),e.$message({message:"Api released successfully",type:"success",duration:5e3,center:!0})})})}),r()(i,"delParamRule",function(t){for(var e=0;e<this.tempApi.param_rules.length;e++)this.tempApi.param_rules[e].param==t&&this.tempApi.param_rules.splice(e,1)}),r()(i,"addVerifyRule",function(){var t=this;if(null==this.tempApi.param_rules)this.tempApi.param_rules=[];else for(var e=0;e<this.tempApi.param_rules.length;e++)if(this.tempVerifyRule.param==this.tempApi.param_rules[e].param)return void this.$message({message:"Param exists",type:"warning",duration:3e3,center:!0});var a={target_app:"juzManage",target_path:"/manage/api/verifyParamRule",param:this.tempVerifyRule.param,rule:this.tempVerifyRule.rule,test_data:this.tempVerifyRule.test_data};Object(u.a)("POST",a).then(function(e){t.tempApi.param_rules.unshift({param:t.tempVerifyRule.param,rule:t.tempVerifyRule.rule,test_data:t.tempVerifyRule.test_data}),t.tempVerifyRule={},t.$message({message:"Test successfully",type:"success",duration:3e3,center:!0})})}),r()(i,"cancelAPIDefine",function(){this.apiDefineVisible=!1}),r()(i,"cancelVerify",function(){this.veryfyVisible=!1}),r()(i,"showVerify",function(){this.tempVerifyRule.param="",this.tempVerifyRule.rule="",this.tempVerifyRule.test_data="",this.veryfyVisible=!0,this.ruleContent="\n         <p><strong>Demo</strong></p>\n        <p>mobile : ^1[0-9]{10}$</p>\n        <p>email : ^([a-z0-9_\\.-]+)@([\\da-z\\.-]+)\\.([a-z\\.]{2,6})$</p>\n\n        <p><strong>Demo analysis</strong></p>\n        <p>1. Let's assume our http params is like this: k1=v1&k2=v2&k3=v3</p>\n        <p>2. Now we want to verify the mobile param,we use the regexp rule: ^1[0-9]{10}$</p>\n        <p>so，a client can access with http://xxx.com/index?mobile=15880271182&email=aaa@bbb.com}</p>\n      "}),r()(i,"onManageSelect",function(t){this.selectManageIndex=t}),r()(i,"handleManage",function(t){var e=this;this.apiDefineStep=0,this.defineStatus="edit",this.tempApi=t;var a={target_app:"juzManage",target_path:"/manage/auditLog/count",target_type:2,target_id:this.tempApi.api_id};Object(u.a)("POST",a).then(function(t){e.totalLogs=t.data.data});a={target_app:"juzManage",target_path:"/manage/auditLog/load",target_type:2,target_id:this.tempApi.api_id,page:1};Object(u.a)("POST",a).then(function(t){e.logs=t.data.data}),this.apiManageVisible=!0}),r()(i,"cancelManage",function(){this.apiManageVisible=!1}),r()(i,"handleEdit",function(){this.apiTitle="Edit API",this.apiDefineVisible=!0,0!=this.tempApi.bw_strategy&&(this.selBW=this.tempApi.bw_strategy),0!=this.tempApi.retry_strategy&&(this.selRetry=this.tempApi.retry_strategy),0!=this.tempApi.traffic_strategy&&(this.selTraffic=this.tempApi.traffic_strategy)}),r()(i,"delApi",function(t){var e=this;""==t.release_version?this.$confirm("Are you sure to delete this api?","Warning",{dangerouslyUseHTMLString:!0,cancelButtonText:"Cancel",confirmButtonText:"Submit",type:"error"}).then(function(){var a={target_app:"juzManage",target_path:"/manage/api/delete",service:t.service,api_id:t.api_id};Object(u.a)("POST",a).then(function(t){200==t.data.status?(e.apiManageVisible=!1,e.loadApis(e.currentPage),e.$message({message:"Delete api successfully",type:"success",duration:3e3,center:!0})):e.$message({message:t.data.message,type:"warning",duration:3e3,center:!0})})}):this.$message({message:"Please offline the api first",type:"warning",duration:3e3,center:!0})}),r()(i,"saveApi",function(){var t=this;if(""!=this.tempApi.api_id)if(""!=this.tempApi.app){var e=n()({},this.tempApi);e.param_rules=c()(e.param_rules),"create"==this.defineStatus&&(e.api_id=this.genAPIIDByType());var a={target_app:"juzManage",target_path:"/manage/api/define",api:e,action:this.defineStatus};Object(u.a)("POST",a).then(function(e){e.data.data.param_rules=JSON.parse(e.data.data.param_rules),t.apiDefineVisible=!1,"create"==t.defineStatus?t.apis.unshift(e.data.data):(t.tempApi=e.data.data,t.loadApis(t.currentPage)),""!=e.data.message?t.$message({message:e.data.message,type:"info",duration:3e3,center:!0}):t.$message({message:"Edit api ok",type:"success",duration:3e3,center:!0})})}else this.$message({message:"You must choose a application the api belongs",type:"error",duration:3e3,center:!0});else this.$message({message:"Api name cant not be empty",type:"error",duration:3e3,center:!0})}),r()(i,"nextDefineStep",function(t){t?this.apiDefineStep++:this.apiDefineStep--}),r()(i,"handleCreate",function(){""!=this.selectedService?(this.apiTitle="Create API",this.apiDefineStep=0,this.tempApi={service:this.selectedService,app:"",api_id:"",version:1,path_type:0,desc:"",route_type:1,addr_type:1,backend_addr:"",backend_uri:"",backend_type:1,mock_data:"",method:"POST",bw_strategy:0,retry_strategy:0,traffic_api:"",traffic_ratio:0,traffic_on:0,traffic_ips:"",verify_on:0,cached_time:0,param_rules:[]},this.apiDefineVisible=!0,this.defineStatus="create"):this.$message({message:"Select a service first",type:"warning",duration:3e3,center:!0})}),r()(i,"calcService",function(){return this.selectedService||this.$store.getters.service}),r()(i,"handleSelService",function(t){this.$store.dispatch("setService",t),this.selectedService=t,this.loadApis(1),this.loadStrategy(this.selectedService),this.loadApps()}),r()(i,"loadStrategy",function(t){var e=this,a={target_app:"juzManage",target_path:"/manage/strategy/load",service:this.selectedService,type:0};Object(u.a)("POST",a).then(function(t){e.strategies=t.data.data})}),r()(i,"loadApis",function(t){var e=this;this.currentPage=t;var a={target_service:this.selectedService,target_app:"juzManage",target_path:"/manage/api/count",q:this.q,service:this.selectedService};Object(u.a)("POST",a).then(function(t){e.totalApis=t.data.data});a={target_service:this.selectedService,target_app:"juzManage",target_path:"/manage/api/query",service:this.selectedService,q:this.q,page:t};Object(u.a)("POST",a).then(function(t){e.apis=t.data.data,console.log(e.apis);for(var a=0;a<e.apis.length;a++)e.apis[a].param_rules=JSON.parse(e.apis[a].param_rules)})}),r()(i,"loadApps",function(){var t=this;Object(m.a)({url:"/ops/app/query",method:"GET",params:{service:this.selectedService}}).then(function(e){t.apps=e.data.data})}),r()(i,"loadServices",function(){var t=this;Object(m.a)({url:"/ops/service/query",method:"GET",params:{}}).then(function(e){t.services=e.data.data})}),i),mounted:function(){this.loadServices(),this.selectedService=this.$store.getters.service,""!=this.selectedService&&(this.loadApps(),this.loadApis(1),this.loadStrategy(this.selectedService))},destroyed:function(){}},k={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-tag",[t._v(" service")]),t._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"160px"},attrs:{clearable:"",value:t.calcService(),placeholder:"请选择Service"},on:{change:t.handleSelService}},t._l(t.services,function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.name}})})),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"success",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("Create API")]),t._v(" "),a("span",{staticStyle:{float:"right","margin-right":"30px"}},[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{icon:"el-icon-upload2"},on:{click:t.batchRelease}},[t._v("Batch Release")]),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-right":"20px"},attrs:{icon:"el-icon-bell"},on:{click:t.handleBatchStrategy}},[t._v("Batch Strategy")]),t._v(" "),a("el-input",{staticClass:"filter-item",staticStyle:{width:"250px"},attrs:{placeholder:"fuzzing search",clearable:""},on:{clear:function(e){t.loadApis(1)}},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.loadApis(1)}},model:{value:t.q,callback:function(e){t.q=e},expression:"q"}}),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"text",icon:"el-icon-search"},on:{click:function(e){t.loadApis(1)}}})],1)],1),t._v(" "),a("div",{staticClass:"table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.apis,fit:"","highlight-current-row":"","default-sort":{prop:"modify_date",order:"descending"}},on:{"selection-change":t.selTableRows}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{align:"left",label:"api id",width:"210",prop:"api_id"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.api_id))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"left",label:"application",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.app))])]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"400",align:"left",label:"backend info"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.backend_type?a("span",[t._v("HTTP(S)-")]):a("span",[t._v("Mock-")]),t._v(" "),1==e.row.addr_type?a("span",[t._v("URL-")]):a("span",[t._v("ETCD-")]),t._v("\n            "+t._s(e.row.backend_addr)+"\n            "),2==e.row.addr_type?a("span",[t._v("-"+t._s(e.row.backend_uri))]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"250",align:"left",label:"status"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("el-tag",{attrs:{type:"success",size:"mini"}},[t._v("edit")]),t._v(" "),a("span",{staticStyle:{color:"#337ab7","font-size":"13px"}},[t._v(t._s(e.row.revise_version))])],1),t._v(" "),""!=e.row.release_version?a("div",{staticStyle:{"margin-top":"3px"}},[a("el-tag",{attrs:{size:"mini",type:t.calcRelease(e.row)}},[t._v("release")]),t._v(" "),a("span",{staticStyle:{color:"#337ab7","font-size":"13px"}},[t._v(t._s(e.row.release_version))])],1):a("div",{staticStyle:{"margin-top":"3px"}},[a("el-tag",{attrs:{type:"warning",size:"mini"}},[t._v("not released")])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"operate","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.release_version!=e.row.revise_version&&""!=e.row.release_version?a("span",{staticClass:"table-op-btn",on:{click:function(a){t.releaseAPI(e.row)}}},[t._v("release")]):t._e(),t._v(" "),""==e.row.release_version?a("span",{staticClass:"table-op-btn",on:{click:function(a){t.releaseAPI(e.row)}}},[t._v("release")]):t._e(),t._v(" "),a("span",{staticClass:"table-op-btn",on:{click:function(a){t.handleManage(e.row)}}},[t._v("manage")]),t._v(" "),a("span",{staticClass:"table-op-btn",on:{click:function(a){t.handleCopy(e.row,a)}}},[t._v("copyConfig")])]}}])})],1),t._v(" "),a("el-pagination",{attrs:{layout:"total,prev, pager, next",total:t.totalApis},on:{"current-change":t.loadApis}})],1),t._v(" "),a("el-dialog",{staticClass:"black-dialog",staticStyle:{backgroud:"rgb(57, 79, 90) !important"},attrs:{title:"Manage API ："+t.tempApi.api_id,visible:t.apiManageVisible,top:"40px",fullscreen:!0},on:{"update:visible":function(e){t.apiManageVisible=e}}},[a("el-row",{staticStyle:{"margin-top":"40px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:3,offset:1}},[a("el-menu",{ref:"apiMenu",staticClass:"el-menu-vertical-demo",attrs:{"default-active":"1","text-color":"#fff","background-color":"rgb(57, 79, 90)","active-text-color":"#ffd04b"},on:{select:t.onManageSelect}},[a("el-menu-item",{attrs:{index:"1"}},[a("i",{staticClass:"el-icon-setting"}),t._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("API Define")])]),t._v(" "),a("el-menu-item",{attrs:{index:"2"}},[a("i",{staticClass:"el-icon-caret-right"}),t._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("API Test")])]),t._v(" "),a("el-menu-item",{attrs:{index:"3"}},[a("i",{staticClass:"el-icon-menu"}),t._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("Audit Log")])]),t._v(" "),a("el-menu-item",{attrs:{index:"4"}},[a("i",{staticClass:"el-icon-bell"}),t._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("Metrics")])])],1)],1),t._v(" "),a("el-col",{staticStyle:{color:"#fff","padding-right":"0"},attrs:{span:20,offset:0}},[a("div",{directives:[{name:"show",rawName:"v-show",value:1==t.selectManageIndex,expression:"selectManageIndex==1"}]},[a("div",{staticStyle:{width:"85%"}},[a("span",{staticStyle:{float:"right","margin-top":"-36px"}},[a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(e){t.handleEdit()}}},[t._v("Edit")]),t._v(" "),t.tempApi.release_version!=t.tempApi.revise_version&&""!=t.tempApi.release_version?a("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(e){t.releaseAPI(t.tempApi)}}},[t._v("Release")]):t._e(),t._v(" "),""==t.tempApi.release_version?a("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(e){t.releaseAPI(t.tempApi)}}},[t._v("Release")]):t._e(),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:""!=t.tempApi.release_version,expression:"tempApi.release_version!=''"}],attrs:{type:"info",size:"small"},on:{click:function(e){t.offlineAPI(t.tempApi)}}},[t._v("Offline")]),t._v(" "),a("el-button",{attrs:{type:"",size:"small"},on:{click:function(e){t.delApi(t.tempApi)}}},[t._v("Delete")])],1),t._v(" "),a("apiDefine",{attrs:{api:t.tempApi,formType:"black-form"}})],1)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:2==t.selectManageIndex,expression:"selectManageIndex==2"}]},[a("apiTest",{attrs:{api:t.tempApi}})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:3==t.selectManageIndex,expression:"selectManageIndex==3"}]},[a("auditLog",{attrs:{totalLogs:t.totalLogs,logs:t.logs,themeType:"black-theme",targetType:2,targetID:t.tempApi.api_id}})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:4==t.selectManageIndex,expression:"selectManageIndex==4"}]},[a("iframe",{staticStyle:{height:"910px",width:"100%",border:"none","margin-top":"-40px"},attrs:{src:t.apiGrafanaAddr(t.tempApi.api_id)}})])])],1)],1),t._v(" "),a("el-dialog",{staticClass:"mf-dialog",attrs:{title:t.apiTitle,visible:t.apiDefineVisible,top:"40px","before-close":t.cancelAPIDefine,fullscreen:!1},on:{"update:visible":function(e){t.apiDefineVisible=e}}},[a("el-steps",{attrs:{active:t.apiDefineStep,"finish-status":"success"}},[a("el-step",{attrs:{title:"Basic"}}),t._v(" "),a("el-step",{attrs:{title:"Request"}}),t._v(" "),a("el-step",{attrs:{title:"Advanced"}})],1),t._v(" "),a("el-row",{staticStyle:{"margin-top":"40px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:20,offset:2}},[a("div",{directives:[{name:"show",rawName:"v-show",value:0==t.apiDefineStep,expression:"apiDefineStep==0"}]},[a("el-form",{attrs:{"label-position":"left","label-width":"110px",size:"small"}},[a("el-form-item",{attrs:{label:"Service"}},[t._v("\n                    "+t._s(t.tempApi.service)+"\n                  ")]),t._v(" "),a("el-form-item",{attrs:{label:"Application",required:""}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"please choose"},model:{value:t.tempApi.app,callback:function(e){t.$set(t.tempApi,"app",e)},expression:"tempApi.app"}},t._l(t.apps,function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.name}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"URL Type"}},[a("el-switch",{attrs:{"active-color":"#13ce66","active-value":t.switchActive,"inactive-value":t.switchInactive,disabled:"edit"==t.defineStatus},model:{value:t.tempApi.path_type,callback:function(e){t.$set(t.tempApi,"path_type",e)},expression:"tempApi.path_type"}}),t._v(" "),1==t.tempApi.path_type?a("el-alert",{attrs:{closable:!1,title:"Client request with http://JUZ_IP/a/b/c",type:"success"}}):a("el-alert",{attrs:{closable:!1,title:"Client request with  http://JUZ_IP/service/api?api_name=abc&api_version=1",type:"success"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"API ID"}},["create"==t.defineStatus?a("span",[t._v(t._s(t.genAPIIDByType()))]):a("span",[t._v(t._s(t.tempApi.api_id))]),t._v(" "),a("el-alert",{attrs:{closable:!1,title:t.apiNameAlert(),type:"warning"}})],1),t._v(" "),"create"==t.defineStatus?a("el-form-item",{staticClass:"first-item",attrs:{label:"API Name",required:""}},[0==t.tempApi.path_type?a("span",[t._v(t._s(t.tempApi.service)+".")]):t._e(),t._v(" "),a("el-tooltip",{staticClass:"no-border-input",attrs:{content:t.apiNameTooltip(),placement:"top"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:""},model:{value:t.tempApi.api_id,callback:function(e){t.$set(t.tempApi,"api_id",e)},expression:"tempApi.api_id"}})],1)],1):a("el-form-item",{staticClass:"first-item",attrs:{label:"API Name",required:""}},[t._v("\n                    "+t._s(t.showName(t.tempApi.api_id))+"\n                  ")]),t._v(" "),a("el-form-item",{attrs:{label:"Version"}},["create"==t.defineStatus?a("el-input-number",{staticClass:"no-border-input",staticStyle:{width:"90px",border:"none"},attrs:{min:1,max:9,size:"mini"},model:{value:t.tempApi.version,callback:function(e){t.$set(t.tempApi,"version",e)},expression:"tempApi.version"}}):a("span",[t._v(t._s(t.showVersion(t.tempApi.api_id)))])],1),t._v(" "),a("el-form-item",{attrs:{label:"Desc"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:"Describe your api"},model:{value:t.tempApi.desc,callback:function(e){t.$set(t.tempApi,"desc",e)},expression:"tempApi.desc"}})],1)],1)],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1==t.apiDefineStep,expression:"apiDefineStep==1"}]},[a("el-form",{attrs:{"label-position":"left","label-width":"150px",size:"small"}},[a("el-form-item",{attrs:{label:"Route Type",prop:"route_type"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"please choose"},model:{value:t.tempApi.route_type,callback:function(e){t.$set(t.tempApi,"route_type",e)},expression:"tempApi.route_type"}},[a("el-option",{attrs:{label:"Direct",value:1}}),t._v(" "),a("el-option",{attrs:{label:"Redirect",value:2}})],1)],1),t._v(" "),a("el-form-item",{staticClass:"first-item",attrs:{label:"Backend Type",prop:"name"}},[a("el-radio-group",{model:{value:t.tempApi.backend_type,callback:function(e){t.$set(t.tempApi,"backend_type",e)},expression:"tempApi.backend_type"}},[a("el-radio",{attrs:{label:1}},[t._v("HTTP(s)")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("Mock")])],1)],1),t._v(" "),1==t.tempApi.backend_type?a("div",[a("el-form-item",{attrs:{label:"HTTP Method"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"200px","margin-top":"8px"},attrs:{placeholder:"select method"},model:{value:t.tempApi.method,callback:function(e){t.$set(t.tempApi,"method",e)},expression:"tempApi.method"}},[a("el-option",{attrs:{label:"GET",value:"GET"}}),t._v(" "),a("el-option",{attrs:{label:"POST",value:"POST"}}),t._v(" "),a("el-option",{attrs:{label:"PUT",value:"PUT"}}),t._v(" "),a("el-option",{attrs:{label:"DELETE",value:"DELETE"}})],1)],1),t._v(" "),a("el-form-item",{staticClass:"first-item",attrs:{label:"Addr Type",prop:"name"}},[a("el-radio-group",{model:{value:t.tempApi.addr_type,callback:function(e){t.$set(t.tempApi,"addr_type",e)},expression:"tempApi.addr_type"}},[a("el-radio",{attrs:{label:1}},[t._v("URL")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("ETCD")])],1)],1),t._v(" "),1==t.tempApi.addr_type?a("div",[a("el-form-item",{attrs:{label:"Backend Addr",required:""}},[a("el-tooltip",{attrs:{content:"The application url you want to access",placement:"top"}},[a("el-input",{attrs:{placeholder:"http://"},model:{value:t.tempApi.backend_addr,callback:function(e){t.$set(t.tempApi,"backend_addr",e)},expression:"tempApi.backend_addr"}})],1)],1)],1):a("div",[a("el-form-item",{attrs:{label:"Backend Addr",required:""}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"160px"},attrs:{clearable:"",placeholder:"select service"},on:{change:t.handleTempService},model:{value:t.tempService,callback:function(e){t.tempService=e},expression:"tempService"}},t._l(t.services,function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.name}})})),t._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"select app"},model:{value:t.tempApi.backend_addr,callback:function(e){t.$set(t.tempApi,"backend_addr",e)},expression:"tempApi.backend_addr"}},t._l(t.tempApps,function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.name}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"Backend URI",required:""}},[a("el-tooltip",{attrs:{content:"Http uri,e.g. if target is 'http://test.com/a/b',here you shold fill in '/a/b'",placement:"top"}},[a("el-input",{attrs:{placeholder:"/a/b"},model:{value:t.tempApi.backend_uri,callback:function(e){t.$set(t.tempApi,"backend_uri",e)},expression:"tempApi.backend_uri"}})],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"Header,Cookie"}},[a("el-tag",{staticStyle:{border:"none"},attrs:{type:"success",size:"large"}},[t._v("Pass through")])],1),t._v(" "),a("el-form-item",{attrs:{label:"Params"}},[a("el-tag",{staticStyle:{border:"none"},attrs:{type:"success",size:"large"}},[t._v("Pass through")])],1)],1):a("div",[a("el-form-item",{attrs:{label:"Mock Data"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:'if you fill with {"a":"b"},juz will directly return the filling content'},model:{value:t.tempApi.mock_data,callback:function(e){t.$set(t.tempApi,"mock_data",e)},expression:"tempApi.mock_data"}}),t._v(" "),a("el-alert",{attrs:{closable:!1,title:"Attention! When mock is used, the client request will get the mock data, the request will never reach the backend service",type:"warning"}})],1)],1)],1)],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:2==t.apiDefineStep,expression:"apiDefineStep==2"}]},[a("el-form",{attrs:{"label-position":"left","label-width":"150px",size:"small"}},[a("div",{staticClass:"form-block"},[a("span",[t._v("Param Verify"),a("el-tag",{staticStyle:{border:"none"},attrs:{type:"success",size:"mini"}},[t._v("optional")])],1),t._v(" "),a("el-form-item",{staticClass:"first-item",staticStyle:{width:"300px"},attrs:{label:"On/Off"}},[a("el-switch",{attrs:{"active-color":"#13ce66","active-value":t.switchActive,"inactive-value":t.switchInactive},model:{value:t.tempApi.verify_on,callback:function(e){t.$set(t.tempApi,"verify_on",e)},expression:"tempApi.verify_on"}})],1),t._v(" "),a("el-form-item",{staticClass:"first-item",staticStyle:{width:"300px"},attrs:{label:"Verify Table"}},[a("el-button",{attrs:{type:"success",icon:"el-icon-edit"},on:{click:t.showVerify}},[t._v("Edit")])],1)],1),t._v(" "),a("div",{staticClass:"form-block"},[a("span",[t._v("Canary Test"),a("el-tag",{staticStyle:{border:"none"},attrs:{type:"success",size:"mini"}},[t._v("optional")])],1),t._v(" "),a("el-form-item",{staticClass:"first-item",staticStyle:{width:"300px"},attrs:{label:"On/Off"}},[a("el-switch",{attrs:{"active-color":"#13ce66","active-value":t.switchActive,"inactive-value":t.switchInactive},model:{value:t.tempApi.traffic_on,callback:function(e){t.$set(t.tempApi,"traffic_on",e)},expression:"tempApi.traffic_on"}})],1),t._v(" "),a("el-form-item",{staticClass:"first-item",staticStyle:{width:"500px"},attrs:{label:"Target APIID"}},[a("el-tooltip",{attrs:{content:"Some traffic will route to this api id",placement:"top"}},[a("el-input",{attrs:{placeholder:""},model:{value:t.tempApi.traffic_api,callback:function(e){t.$set(t.tempApi,"traffic_api",e)},expression:"tempApi.traffic_api"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"Traffic Ratio",prop:"req_timeout"}},[a("el-tooltip",{attrs:{content:"e.g. 10 means 10% traffic will route to the api id above",placement:"top"}},[a("el-input-number",{attrs:{min:1,max:100},model:{value:t.tempApi.traffic_ratio,callback:function(e){t.$set(t.tempApi,"traffic_ratio",e)},expression:"tempApi.traffic_ratio"}})],1)],1),t._v(" "),a("el-form-item",{staticClass:"first-item",staticStyle:{width:"400px"},attrs:{label:"IP List"}},[a("el-tooltip",{attrs:{content:"Controls which ip will be routed,if not control,routed will be randomly",placement:"top"}},[a("el-input",{attrs:{placeholder:"Separate ips with Spaces"},model:{value:t.tempApi.traffic_ips,callback:function(e){t.$set(t.tempApi,"traffic_ips",e)},expression:"tempApi.traffic_ips"}})],1)],1)],1),t._v(" "),a("el-alert",{staticStyle:{"margin-top":"8px"},attrs:{title:"Tips: you need to create strategy in strategy page first",closable:!1,type:"success"}}),t._v(" "),a("div",{staticClass:"form-block"},[a("span",[t._v("White/Black List"),a("el-tag",{staticStyle:{border:"none"},attrs:{type:"success",size:"mini"}},[t._v("optional")])],1),t._v(" "),a("el-form-item",{staticClass:"first-item",attrs:{label:"Strategy",prop:"req_timeout"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"please choose"},on:{change:t.selectBW},model:{value:t.selBW,callback:function(e){t.selBW=e},expression:"selBW"}},t._l(t.filterStrategies(1),function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.id}})})),t._v(" "),a("el-popover",{directives:[{name:"show",rawName:"v-show",value:""!=this.selBW,expression:"this.selBW != ''"}],attrs:{placement:"top",width:"600",trigger:"click"}},[a("bwlist",{attrs:{strategy:t.strategy}}),t._v(" "),a("i",{staticClass:"el-icon-view hover-cursor icon-primary",staticStyle:{"margin-left":"8px"},attrs:{slot:"reference"},on:{click:function(e){t.getStrategy(t.selBW)}},slot:"reference"})],1)],1)],1),t._v(" "),a("div",{staticClass:"form-block"},[a("span",[t._v("Timeout/Retry"),a("el-tag",{staticStyle:{border:"none"},attrs:{type:"success",size:"mini"}},[t._v("optional")])],1),t._v(" "),a("el-form-item",{staticClass:"first-item",attrs:{label:"Strategy",prop:"req_timeout"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"please choose"},on:{change:t.selectRetry},model:{value:t.selRetry,callback:function(e){t.selRetry=e},expression:"selRetry"}},t._l(t.filterStrategies(2),function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.id}})})),t._v(" "),a("el-popover",{directives:[{name:"show",rawName:"v-show",value:""!=this.selRetry,expression:"this.selRetry != ''"}],attrs:{placement:"top",width:"600",trigger:"click"}},[a("retry",{attrs:{strategy:t.strategy}}),t._v(" "),a("i",{staticClass:"el-icon-view hover-cursor icon-primary",staticStyle:{"margin-left":"8px"},attrs:{slot:"reference"},on:{click:function(e){t.getStrategy(t.selRetry)}},slot:"reference"})],1)],1)],1),t._v(" "),a("div",{staticClass:"form-block"},[a("span",[t._v("Traffic Control"),a("el-tag",{staticStyle:{border:"none"},attrs:{type:"success",size:"mini"}},[t._v("optional")])],1),t._v(" "),a("el-form-item",{staticClass:"first-item",attrs:{label:"Strategy",prop:"req_timeout"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"please choose"},on:{change:t.selectTraffic},model:{value:t.selTraffic,callback:function(e){t.selTraffic=e},expression:"selTraffic"}},t._l(t.filterStrategies(3),function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.id}})})),t._v(" "),a("el-popover",{directives:[{name:"show",rawName:"v-show",value:""!=this.selTraffic,expression:"this.selTraffic != ''"}],attrs:{placement:"top",width:"600",trigger:"click"}},[a("traffic",{attrs:{strategy:t.strategy}}),t._v(" "),a("i",{staticClass:"el-icon-view hover-cursor icon-primary",staticStyle:{"margin-left":"8px"},attrs:{slot:"reference"},on:{click:function(e){t.getStrategy(t.selTraffic)}},slot:"reference"})],1)],1)],1)],1)],1)])],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!=t.apiDefineStep,expression:"apiDefineStep!=0"}],on:{click:function(e){t.nextDefineStep(!1)}}},[t._v("Prev")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2!=t.apiDefineStep,expression:"apiDefineStep!=2"}],attrs:{type:"success"},on:{click:function(e){t.nextDefineStep(!0)}}},[t._v("Next")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!=t.apiDefineStep,expression:"apiDefineStep!=0"}],attrs:{type:"primary"},on:{click:t.saveApi}},[t._v("Save")])],1)],1),t._v(" "),a("el-dialog",{staticClass:"mf-dialog",attrs:{title:"Param Verify",fullscreen:!0,visible:t.veryfyVisible},on:{"update:visible":function(e){t.veryfyVisible=e}}},[a("el-row",{staticStyle:{"margin-top":"0px"},attrs:{gutter:20}},[a("el-col",{staticStyle:{"border-right":".5px solid #999"},attrs:{xs:{span:24},sm:{span:18},md:{span:8},lg:{span:6}}},[a("div",{domProps:{innerHTML:t._s(t.ruleContent)}})]),t._v(" "),a("el-col",{attrs:{span:16,offset:1}},[a("el-form",{attrs:{"label-position":"left","label-width":"70px"}},[a("div",[a("span",[t._v("Create rule for  "),a("strong",[t._v(t._s(t.tempApi.api_id))])]),t._v(" "),a("el-form-item",{staticStyle:{"margin-top":"15px"},attrs:{label:"Param"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"Param name"},model:{value:t.tempVerifyRule.param,callback:function(e){t.$set(t.tempVerifyRule,"param",e)},expression:"tempVerifyRule.param"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Rule"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"regexp format"},model:{value:t.tempVerifyRule.rule,callback:function(e){t.$set(t.tempVerifyRule,"rule",e)},expression:"tempVerifyRule.rule"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Test data"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"input test data for test the rule"},model:{value:t.tempVerifyRule.test_data,callback:function(e){t.$set(t.tempVerifyRule,"test_data",e)},expression:"tempVerifyRule.test_data"}})],1),t._v(" "),a("el-button",{attrs:{type:"success"},on:{click:t.addVerifyRule}},[t._v("Test and Create")])],1)]),t._v(" "),a("div",{staticClass:"table",staticStyle:{"margin-top":"15px","overflow-y":"auto"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tempApi.param_rules,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"Param",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.param))])]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"400",align:"center",label:"Rule"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.rule))])]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"250",align:"center",label:"Test Data"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.test_data))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"Operate","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-minus",circle:""},on:{click:function(a){t.delParamRule(e.row.param)}}})]}}])})],1)],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.cancelVerify}},[t._v("Close")])],1)],1),t._v(" "),a("el-dialog",{staticClass:"mf-dialog",attrs:{title:"Batch Strategy Setting",visible:t.batchStrategyVisible},on:{"update:visible":function(e){t.batchStrategyVisible=e}}},[a("el-form",{staticStyle:{width:"650px","margin-left":"50px"},attrs:{"label-position":"left","label-width":"120px",size:"mini"}},[a("div",{staticClass:"form-block"},[a("span",[t._v("Batch Strategy")]),t._v(" "),a("el-alert",{staticStyle:{"margin-top":"8px"},attrs:{title:"Warning: batch setting will overide the api's specific setting, please operate with caution!",closable:!1,type:"warning"}}),t._v(" "),a("el-alert",{staticStyle:{"margin-top":"8px"},attrs:{title:"Tips: the unselected strategy will be ignored, it will not setting your api's corresponding strategy to null",closable:!1,type:"success"}}),t._v(" "),a("div",{staticClass:"form-block"},[a("span",[t._v("White/Black List")]),t._v(" "),a("el-form-item",{attrs:{label:"Stategy"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"please choose"},model:{value:t.batchBW,callback:function(e){t.batchBW=e},expression:"batchBW"}},t._l(t.filterStrategies(1),function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.id}})})),t._v(" "),a("el-popover",{directives:[{name:"show",rawName:"v-show",value:""!=this.batchBW,expression:"this.batchBW != ''"}],attrs:{placement:"top",width:"600",trigger:"click"}},[a("bwlist",{attrs:{strategy:t.strategy}}),t._v(" "),a("i",{staticClass:"el-icon-view hover-cursor icon-primary",staticStyle:{"margin-left":"8px"},attrs:{slot:"reference"},on:{click:function(e){t.getStrategy(t.batchBW)}},slot:"reference"})],1)],1)],1),t._v(" "),a("div",{staticClass:"form-block"},[a("span",[t._v("Timeout/Retry")]),t._v(" "),a("el-form-item",{attrs:{label:"Strategy",prop:"req_timeout"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"please choose"},model:{value:t.batchRetry,callback:function(e){t.batchRetry=e},expression:"batchRetry"}},t._l(t.filterStrategies(2),function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.id}})})),t._v(" "),a("el-popover",{directives:[{name:"show",rawName:"v-show",value:""!=this.batchRetry,expression:"this.batchRetry != ''"}],attrs:{placement:"top",width:"600",trigger:"click"}},[a("retry",{attrs:{strategy:t.strategy}}),t._v(" "),a("i",{staticClass:"el-icon-view hover-cursor icon-primary",staticStyle:{"margin-left":"8px"},attrs:{slot:"reference"},on:{click:function(e){t.getStrategy(t.batchRetry)}},slot:"reference"})],1)],1)],1),t._v(" "),a("div",{staticClass:"form-block"},[a("span",[t._v("Traffic Control")]),t._v(" "),a("el-form-item",{attrs:{label:"选择策略",prop:"req_timeout"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"please choose"},model:{value:t.batchTraffic,callback:function(e){t.batchTraffic=e},expression:"batchTraffic"}},t._l(t.filterStrategies(3),function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.id}})})),t._v(" "),a("el-popover",{directives:[{name:"show",rawName:"v-show",value:""!=this.batchTraffic,expression:"this.batchTraffic != ''"}],attrs:{placement:"top",width:"600",trigger:"click"}},[a("traffic",{attrs:{strategy:t.strategy}}),t._v(" "),a("i",{staticClass:"el-icon-view hover-cursor icon-primary",staticStyle:{"margin-left":"8px"},attrs:{slot:"reference"},on:{click:function(e){t.getStrategy(t.batchTraffic)}},slot:"reference"})],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"form-block",staticStyle:{"padding-bottom":"20px"}},[a("span",[t._v("Batch Delete Strategy")]),t._v(" "),a("el-alert",{staticStyle:{"margin-top":"8px"},attrs:{title:"Warning: batch setting will delete the api's specific setting, please operate with caution!",closable:!1,type:"warning"}}),t._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-button",{on:{click:function(e){t.batchDelStrategy(1)}}},[t._v("Del White/Black")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},on:{click:function(e){t.batchDelStrategy(2)}}},[t._v("Del Timeout/Retry")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},on:{click:function(e){t.batchDelStrategy(2)}}},[t._v("Del Traffic Control")])],1)],1)]),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.batchStrategyVisible=!1}}},[t._v("Cancel")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.submitBatchStrategy}},[a("span",[t._v("Submit")])])],1)],1)],1)},staticRenderFns:[]};var A=a("VU/8")(x,k,!1,function(t){a("gTO2"),a("O+8a")},"data-v-284fcbf2",null);e.default=A.exports},"O+8a":function(t,e,a){var i=a("g3Op");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("8b65b4e4",i,!0)},Qjo9:function(t,e,a){"use strict";var i=a("M+K7"),s=a("WyEh"),r=a("zHTQ"),l=a("qQ+w"),n={name:"paramRules",props:{rules:{type:Array,default:[]}},components:{},data:function(){return{}},methods:{},created:function(){},mounted:function(){},destroyed:function(){}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"param-rules"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.rules,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"Param",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.param))])]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"400",align:"center",label:"Rule"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.rule))])]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"250",align:"center",label:"Test Data"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.test_data))])]}}])})],1)],1)},staticRenderFns:[]},c=a("VU/8")(n,o,!1,null,null,null).exports,p={name:"apiDefine",props:{api:{type:Object,default:{}},formType:{type:String,default:"white-form"}},components:{bwlist:s.a,retry:r.a,paramRules:c,traffic:l.a},data:function(){return{strategies:[],strategy:{content:{}},rules:[]}},methods:{showName:function(t){return t.substring(0,t.length-3)},showVersion:function(t){return t[t.length-1]},getParamRules:function(){this.rules=JSON.parse(this.api.param_rules)},getStrategy:function(t){var e=this,a={target_app:"juzManage",target_path:"/manage/strategy/query",id:t};Object(i.a)("POST",a).then(function(t){e.strategy=t.data.data,e.strategy.content=JSON.parse(e.strategy.content)})},calcRelease:function(t){return t.release_version==t.revise_version?"success":"warning"},isBlackForm:function(){return"black-form"==this.formType}},mounted:function(){},destroyed:function(){}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"api-define"},[a("div",[a("el-alert",{attrs:{closable:!1,title:"Basic",type:"warning"}})],1),t._v(" "),a("el-form",{class:{"black-form":t.isBlackForm()},attrs:{"label-position":"left","label-width":"150px",size:"small"}},[a("el-form-item",{staticClass:"first-item",attrs:{label:"Service"}},[t._v("\n            "+t._s(t.api.service)+"\n        ")]),t._v(" "),a("el-form-item",{staticClass:"first-item",attrs:{label:"App"}},[t._v("\n            "+t._s(t.api.app)+"\n        ")]),t._v(" "),a("el-form-item",{staticClass:"first-item",attrs:{label:"API ID"}},[t._v("\n            "+t._s(t.api.api_id)+"\n        ")]),t._v(" "),a("el-form-item",{staticClass:"first-item",attrs:{label:"API Name"}},[t._v("\n            "+t._s(t.showName(t.api.api_id))+"\n        ")]),t._v(" "),a("el-form-item",{staticClass:"first-item",attrs:{label:"Version"}},[t._v("\n            "+t._s(t.showVersion(t.api.api_id))+"\n        ")]),t._v(" "),a("el-form-item",{attrs:{label:"Desc"}},[t._v("\n            "+t._s(t.api.desc)+"\n        ")]),t._v(" "),a("el-form-item",{attrs:{label:"Status"}},[a("div",[a("el-tag",{attrs:{type:"success"}},[t._v("editVer")]),t._v(" "),a("span",{staticStyle:{"font-size":"13px"}},[t._v(t._s(t.api.revise_version))])],1),t._v(" "),""!=t.api.release_version?a("div",{staticStyle:{"margin-top":"3px"}},[a("el-tag",{attrs:{type:t.calcRelease(t.api)}},[t._v("releaseVer")]),t._v(" "),a("span",{staticStyle:{"font-size":"13px"}},[t._v(t._s(t.api.release_version))])],1):a("div",{staticStyle:{"margin-top":"3px"}},[a("el-tag",{attrs:{type:"warning"}},[t._v("not released")])],1)])],1),t._v(" "),a("div",[a("el-alert",{attrs:{closable:!1,title:"Request",type:"success"}})],1),t._v(" "),a("el-form",{class:{"black-form":t.isBlackForm()},attrs:{"label-position":"left","label-width":"150px",size:"small"}},[a("el-form-item",{staticClass:"first-item",attrs:{label:"Backend Type"}},[1==t.api.backend_type?a("span",[t._v("HTTP(s)")]):t._e(),t._v(" "),2==t.api.backend_type?a("span",[t._v("Mock")]):t._e()]),t._v(" "),1==t.api.backend_type?a("div",[a("el-form-item",{attrs:{label:"Addr Type"}},[1==t.api.addr_type?a("span",[t._v("URL")]):a("span",[t._v("ETCD")])]),t._v(" "),a("el-form-item",{attrs:{label:"Backend Addr"}},[t._v("\n                "+t._s(t.api.backend_addr)+"\n            ")]),t._v(" "),2==t.api.addr_type?a("el-form-item",{attrs:{label:"Backend Uri"}},[t._v("\n                "+t._s(t.api.backend_uri)+"\n            ")]):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"Header,Cookie"}},[a("el-tag",{staticStyle:{border:"none"},attrs:{type:"success",size:"large"}},[t._v("Pass through")])],1),t._v(" "),a("el-form-item",{attrs:{label:"Params"}},[a("el-tag",{staticStyle:{border:"none"},attrs:{type:"success",size:"large"}},[t._v("Pass through")])],1)],1):a("div",[a("el-form-item",{attrs:{label:"Mock Data"}},[t._v("\n                "+t._s(t.api.mock_data)+"\n            ")])],1)],1),t._v(" "),a("div",[a("el-alert",{attrs:{closable:!1,title:"Advance",type:"info"}})],1),t._v(" "),a("el-form",{class:{"black-form":t.isBlackForm()},attrs:{"label-position":"left","label-width":"150px",size:"small"}},[a("div",{staticClass:"form-block",staticStyle:{"margin-top":"10px"}},[a("span",[t._v("Param Verify")]),t._v(" "),a("el-form-item",{staticClass:"first-item",staticStyle:{width:"300px"},attrs:{label:"Status"}},[1==t.api.verify_on?a("span",[t._v("On")]):a("span",[t._v("Off")])]),t._v(" "),a("el-form-item",{staticClass:"first-item",staticStyle:{width:"300px"},attrs:{label:"Verify Table"}},[a("el-popover",{attrs:{placement:"top",width:"800",trigger:"click"}},[a("paramRules",{attrs:{rules:t.rules}}),t._v(" "),a("i",{staticClass:"el-icon-view hover-cursor icon-primary",staticStyle:{"margin-left":"8px"},attrs:{slot:"reference"},on:{click:function(e){t.getParamRules()}},slot:"reference"})],1)],1)],1),t._v(" "),a("div",{staticClass:"form-block"},[a("span",[t._v("Canary Test")]),t._v(" "),a("el-form-item",{staticClass:"first-item",staticStyle:{width:"300px"},attrs:{label:"Status"}},[1==t.api.traffic_on?a("span",[t._v("On")]):a("span",[t._v("Off")])]),t._v(" "),a("el-form-item",{staticClass:"first-item",staticStyle:{width:"500px"},attrs:{label:"Target APIID",prop:"req_timeout"}},[t._v("\n                "+t._s(t.api.traffic_api)+"\n            ")]),t._v(" "),a("el-form-item",{attrs:{label:"Traffic Ratio",prop:"req_timeout"}},[t._v("\n                "+t._s(t.api.traffic_ratio)+"\n            ")]),t._v(" "),a("el-form-item",{staticClass:"first-item",staticStyle:{width:"300px"},attrs:{label:"IP List"}},[t._v("\n                "+t._s(t.api.traffic_ips)+"\n            ")])],1),t._v(" "),a("div",{staticClass:"form-block"},[a("span",[t._v("White/Black List")]),t._v(" "),0!=t.api.bw_strategy?a("el-form-item",{staticClass:"first-item",attrs:{label:"Strategy"}},[t._v("\n                "+t._s(t.api.bw_strategy)+" \n                "),a("el-popover",{attrs:{placement:"top",width:"600",trigger:"click"}},[a("bwlist",{attrs:{strategy:t.strategy}}),t._v(" "),a("i",{staticClass:"el-icon-view hover-cursor icon-primary",staticStyle:{"margin-left":"8px"},attrs:{slot:"reference"},on:{click:function(e){t.getStrategy(t.api.bw_strategy)}},slot:"reference"})],1)],1):a("el-form-item",{staticClass:"first-item",attrs:{label:"no strategy"}})],1),t._v(" "),a("div",{staticClass:"form-block"},[a("span",[t._v("Timeout/Retry")]),t._v(" "),0!=t.api.retry_strategy?a("el-form-item",{staticClass:"first-item",attrs:{label:"Strategy"}},[t._v("\n                "+t._s(t.api.retry_strategy)+"\n                "),a("el-popover",{attrs:{placement:"top",width:"600",trigger:"click"}},[a("retry",{attrs:{strategy:t.strategy}}),t._v(" "),a("i",{staticClass:"el-icon-view hover-cursor icon-primary",staticStyle:{"margin-left":"8px"},attrs:{slot:"reference"},on:{click:function(e){t.getStrategy(t.api.retry_strategy)}},slot:"reference"})],1)],1):a("el-form-item",{staticClass:"first-item",attrs:{label:"no strategy"}})],1),t._v(" "),a("div",{staticClass:"form-block"},[a("span",[t._v("Traffic Control")]),t._v(" "),0!=t.api.traffic_strategy?a("el-form-item",{staticClass:"first-item",attrs:{label:"Strategy"}},[t._v("\n                "+t._s(t.api.traffic_strategy)+"\n                "),a("el-popover",{attrs:{placement:"top",width:"600",trigger:"click"}},[a("traffic",{attrs:{strategy:t.strategy}}),t._v(" "),a("i",{staticClass:"el-icon-view hover-cursor icon-primary",staticStyle:{"margin-left":"8px"},attrs:{slot:"reference"},on:{click:function(e){t.getStrategy(t.api.traffic_strategy)}},slot:"reference"})],1)],1):a("el-form-item",{staticClass:"first-item",attrs:{label:"no strategy"}})],1)])],1)},staticRenderFns:[]};var m=a("VU/8")(p,u,!1,function(t){a("hw7T"),a("GfrX")},"data-v-406bb816",null);e.a=m.exports},WWAb:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.el-dialog__body {\n  padding-top: 0 !important;\n}\n",""])},WyEh:function(t,e,a){"use strict";var i={name:"bwlist",props:{strategy:{type:Object,default:{}}},components:{},data:function(){return{}},methods:{},created:function(){},mounted:function(){},destroyed:function(){}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bwlist"},[a("el-form",{attrs:{"label-position":"left","label-width":"70px",size:"mini"}},[a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"Name"}},[t._v("\n            "+t._s(t.strategy.name)+"\n        ")]),t._v(" "),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"Type"}},[1==t.strategy.sub_type?a("span",[t._v("Black")]):a("span",[t._v("White")])]),t._v(" "),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"List"}},t._l(t.strategy.content,function(e){return a("div",{key:e.val},[a("el-tag",{attrs:{type:"success",size:"small"}},[t._v(t._s(e.key))]),t._v(" "),a("el-tag",{attrs:{type:"warning",size:"small"}},[t._v(t._s(e.val))])],1)}))],1)],1)},staticRenderFns:[]},r=a("VU/8")(i,s,!1,null,null,null);e.a=r.exports},bOdI:function(t,e,a){"use strict";e.__esModule=!0;var i,s=a("C4MV"),r=(i=s)&&i.__esModule?i:{default:i};e.default=function(t,e,a){return e in t?(0,r.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},g3Op:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.no-border-input .el-input__inner {\n  border-top: none;\n  border-left: none;\n  border-right: none;\n  border-radius: 0;\n  height: 26px;\n}\n.no-border-input .el-input--mini input {\n  border-bottom: none;\n}\n.no-border-input span {\n  border: none !important;\n}\n.el-input.is-disabled .el-input__inner {\n  color: black;\n}\n.el-textarea.is-disabled .el-textarea__inner {\n  color: black;\n}\n.el-input.el-input-group--prepend .el-input-group__prepend {\n  color: black;\n}\n.note {\n  font-size: 13px;\n  margin-top: 0px;\n}\n",""])},gTO2:function(t,e,a){var i=a("EkxJ");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("4e235074",i,!0)},hw7T:function(t,e,a){var i=a("00Oy");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("7ccf5297",i,!0)},mClu:function(t,e,a){var i=a("kM2E");i(i.S+i.F*!a("+E39"),"Object",{defineProperty:a("evD5").f})},"qQ+w":function(t,e,a){"use strict";var i={name:"traffic",props:{strategy:{type:Object,default:{}}},components:{},data:function(){return{}},methods:{},created:function(){},mounted:function(){},destroyed:function(){}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"traffic"},[a("el-form",{attrs:{"label-position":"left","label-width":"70px",size:"mini"}},[a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"Name"}},[t._v("\n            "+t._s(t.strategy.name)+"\n        ")]),t._v(" "),a("div",{staticClass:"form-block"},[a("span",[t._v("Api Traffic")]),t._v(" "),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"QPS"}},[t._v("\n              "+t._s(t.strategy.content.qps)+"\n          ")]),t._v(" "),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"Concurrent"}},[t._v("\n              "+t._s(t.strategy.content.concurrent)+"\n          ")])],1),t._v(" "),a("div",{staticClass:"form-block"},[a("span",[t._v("User Quota")]),t._v(" "),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"Param"}},[t._v("\n                  "+t._s(t.strategy.content.param)+"\n              ")]),t._v(" "),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"Time Span"}},[t._v("\n                  "+t._s(t.strategy.content.span)+"\n              ")]),t._v(" "),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"Access Times"}},[t._v("\n                  "+t._s(t.strategy.content.times)+"\n              ")])],1)],1)],1)},staticRenderFns:[]},r=a("VU/8")(i,s,!1,null,null,null);e.a=r.exports},zHTQ:function(t,e,a){"use strict";var i={name:"retry",props:{strategy:{type:Object,default:{}}},components:{},data:function(){return{}},methods:{},created:function(){},mounted:function(){},destroyed:function(){}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"retry"},[a("el-form",{attrs:{"label-position":"left","label-width":"70px",size:"mini"}},[a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"Name"}},[t._v("\n            "+t._s(t.strategy.name)+"\n        ")]),t._v(" "),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"Retry Timeout"}},[t._v("\n            "+t._s(t.strategy.content.req_timeout)+"\n        ")]),t._v(" "),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"Retry Times"}},[t._v("\n            "+t._s(t.strategy.content.retry_times)+"\n        ")]),t._v(" "),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"Interval"}},[t._v("\n            "+t._s(t.strategy.content.retry_interval)+"\n        ")])],1)],1)},staticRenderFns:[]},r=a("VU/8")(i,s,!1,null,null,null);e.a=r.exports}});