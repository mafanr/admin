webpackJsonp([12],{ymIg:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("vLgD"),r={name:"metrics",data:function(){return{services:[],selectedService:"",apps:[],selectedApp:"",metricsVisible:!1,targetType:"",targetName:"",viewUrl:""}},methods:{viewMetrics:function(){return""!=this.selectedApp?(this.targetName=this.selectedApp,this.viewUrl=Object({NODE_ENV:"production",ENV_CONFIG:"prod",BASE_API:"http://47.91.140.160:9091",TFE_ADDR:"http://47.91.140.160:8081/service/api",API_GRAFANA:"http://47.91.140.160:3000/d/1ZLGyLtiz/tfe-api?refresh=5s&orgId=1&var-api_id=",SERVICE_GRAFANA:"http://47.91.140.160::3000/d/gFZ_ZUtik/tfe-service?refresh=5s&orgId=1&var-service=",LABEL_GRAFANA:"http://47.91.140.160::3000/d/UXhO2Upik/tfe-label?refresh=5s&orgId=1&var-label=",ENV:"生产"}).APP_GRAFANA+this.targetName,this.targetType="Service",void(this.metricsVisible=!0)):""!=this.selectedService?(this.targetName=this.selectedService,this.viewUrl="http://47.91.140.160::3000/d/gFZ_ZUtik/tfe-service?refresh=5s&orgId=1&var-service="+this.targetName,this.targetType="APP",void(this.metricsVisible=!0)):void this.$message({message:"You have not select any service or app",type:"warning",duration:3e3})},handleSelService:function(e){this.$store.dispatch("setService",e),this.selectedService=e},calcService:function(){return this.selectedService||this.$store.getters.service},loadApps:function(){var e=this;Object(s.a)({url:"/ops/app/query",method:"GET",params:{service:this.selectedService}}).then(function(t){e.apps=t.data.data})},loadServices:function(){var e=this;Object(s.a)({url:"/ops/service/query",method:"GET",params:{}}).then(function(t){e.services=t.data.data})}},mounted:function(){this.loadServices(),this.selectedService=this.$store.getters.service,""!=this.selectedService&&this.loadApps()},destroyed:function(){}},a={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-tag",{attrs:{type:"info"}},[e._v(" service")]),e._v(" "),i("el-select",{staticClass:"filter-item",staticStyle:{width:"160px"},attrs:{clearable:"",value:e.calcService(),placeholder:"select service"},on:{change:e.handleSelService}},e._l(e.services,function(e){return i("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})}))],1),e._v(" "),i("div",{staticClass:"filter-container"},[i("el-tag",{attrs:{type:"info"}},[e._v("app")]),e._v(" "),i("el-select",{staticClass:"filter-item margin-left-20",staticStyle:{width:"160px"},attrs:{clearable:"",placeholder:"select app"},model:{value:e.selectedApp,callback:function(t){e.selectedApp=t},expression:"selectedApp"}},e._l(e.apps,function(e){return i("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})}))],1),e._v(" "),i("el-alert",{staticStyle:{width:"400px"},attrs:{title:"You can view either service or app's metrics",closable:!1,type:"warning"}}),e._v(" "),i("div",{staticClass:"filter-container margin-top-10"},[i("el-button",{staticClass:"filter-item",attrs:{type:"success",icon:"el-icon-edit"},on:{click:e.viewMetrics}},[e._v("View metrics")])],1),e._v(" "),i("el-dialog",{staticStyle:{backgroud:"rgb(57, 79, 90) !important"},attrs:{title:"now"+e.targetType+"："+e.targetName,visible:e.metricsVisible,top:"40px",fullscreen:!0},on:{"update:visible":function(t){e.metricsVisible=t}}},[i("iframe",{staticStyle:{height:"910px",width:"100%",border:"none","margin-top":"-40px"},attrs:{src:e.viewUrl}})])],1)},staticRenderFns:[]},c=i("VU/8")(r,a,!1,null,null,null);t.default=c.exports}});