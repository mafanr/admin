webpackJsonp([8],{Y8ip:function(e,t,i){var a=i("yqXf");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i("rjj0")("24a1973d",a,!0)},jWfD:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("woOf"),r=i.n(a),s=i("cAgV"),n=(i("M+K7"),i("vMJZ")),l=i("vLgD"),c={name:"service",directives:{waves:s.a},data:function(){return{services:[],users:[],createServiceVisible:!1,tempCreate:{name:""},tempEdit:{},editServiceVisible:!1,tempService:{},metricsVisible:!1,editServiceUser:"",editServicePriv:"",editServiceUsers:[]}},methods:{delServiceUser:function(e){var t=this;this.$confirm("Are you sure to remove the user : "+e+"?","Warning",{dangerouslyUseHTMLString:!0,cancelButtonText:"cancel",confirmButtonText:"submit",type:"warning"}).then(function(){Object(l.a)({url:"/ops/service/delUser",method:"POST",params:{service:t.tempEdit.name,username:e}}).then(function(i){for(var a=0;a<t.editServiceUsers.length;a++)t.editServiceUsers[a].username==e&&t.editServiceUsers.splice(a,1)})})},addServiceUser:function(){var e=this;Object(l.a)({url:"/ops/service/addUser",method:"POST",params:{service:this.tempEdit.name,username:this.editServiceUser,priv:this.editServicePriv}}).then(function(t){e.editServiceUsers.push({username:e.editServiceUser,priv:e.editServicePriv}),e.editServiceUser="",e.editServicePriv=""})},handleEdit:function(e){this.tempEdit=r()({},e),this.loadServiceUsers(),this.editServiceVisible=!0},handleCreate:function(){this.tempCreate={},this.createServiceVisible=!0},editSubmit:function(){var e=this;Object(l.a)({url:"/ops/service/update",method:"POST",params:{service:this.tempEdit.name,desc:this.tempEdit.desc,owner:this.tempEdit.owner}}).then(function(t){e.loadData(),e.tempEdit={},e.editServiceVisible=!1,e.$message({message:"编辑成功",type:"success",duration:3e3,center:!0})})},createSubmit:function(){var e=this;Object(l.a)({url:"/ops/service/create",method:"POST",params:{service:this.tempCreate.name,desc:this.tempCreate.desc,owner:this.tempCreate.owner}}).then(function(t){e.loadData(),e.tempCreate={name:""},e.createServiceVisible=!1,e.$message({message:"创建成功",type:"success",duration:3e3,center:!0})})},loadData:function(){var e=this;Object(l.a)({url:"/ops/service/query",method:"GET"}).then(function(t){e.services=t.data.data})},loadServiceUsers:function(){var e=this;Object(l.a)({url:"/ops/service/queryUser",method:"GET",params:{service:this.tempEdit.name}}).then(function(t){e.editServiceUsers=t.data.data})}},mounted:function(){var e=this;this.loadData(),Object(n.a)().then(function(t){e.users=t.data.data})},destroyed:function(){}},o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"success",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("Add Service")])],1),e._v(" "),i("div",{staticClass:"table"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.services,border:"",fit:"","highlight-current-row":"","default-sort":{prop:"modify_date",order:"descending"}}},[i("el-table-column",{attrs:{align:"center",label:"Name",width:"250",prop:"name",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"200",align:"center",label:"Owner",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.owner))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"350",align:"center",label:"Description"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.desc))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"Operate","class-name":"small-padding"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){e.handleEdit(t.row)}}},[e._v("Edit")])]}}])})],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"Create service",visible:e.createServiceVisible},on:{"update:visible":function(t){e.createServiceVisible=t}}},[i("el-form",{staticStyle:{width:"500px","margin-left":"50px"},attrs:{model:e.tempCreate,"label-position":"left","label-width":"70px"}},[i("el-form-item",{attrs:{label:"name",prop:"name"}},[i("el-input",{attrs:{placeholder:"only support alhpabet,once created,it cant be changed"},model:{value:e.tempCreate.name,callback:function(t){e.$set(e.tempCreate,"name",t)},expression:"tempCreate.name"}})],1),e._v(" "),i("el-form-item",{staticStyle:{"margin-top":"25px"},attrs:{label:"owner"}},[i("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"select user",filterable:""},model:{value:e.tempCreate.owner,callback:function(t){e.$set(e.tempCreate,"owner",t)},expression:"tempCreate.owner"}},e._l(e.users,function(e){return i("el-option",{key:e.id,attrs:{label:e.username,value:e.username}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"desc"}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"describe the service"},model:{value:e.tempCreate.desc,callback:function(t){e.$set(e.tempCreate,"desc",t)},expression:"tempCreate.desc"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.createServiceVisible=!1}}},[e._v("Cancel")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.createSubmit}},[e._v("Submit")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"Edit Service",visible:e.editServiceVisible},on:{"update:visible":function(t){e.editServiceVisible=t}}},[i("el-form",{staticStyle:{width:"550px","margin-left":"50px"},attrs:{model:e.tempEdit,"label-position":"left","label-width":"120px"}},[i("el-form-item",{attrs:{label:"Name",prop:"name"}},[e._v("\n            "+e._s(e.tempEdit.name)+"\n        ")]),e._v(" "),i("el-form-item",{attrs:{label:"desc"}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"describe the service"},model:{value:e.tempEdit.desc,callback:function(t){e.$set(e.tempEdit,"desc",t)},expression:"tempEdit.desc"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"set user priv"}},[i("el-select",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"select user",filterable:""},model:{value:e.editServiceUser,callback:function(t){e.editServiceUser=t},expression:"editServiceUser"}},e._l(e.users,function(e){return i("el-option",{key:e.id,attrs:{label:e.username,value:e.username}})})),e._v(" "),i("el-select",{staticClass:"filter-item",staticStyle:{width:"120px"},attrs:{placeholder:"select priv"},model:{value:e.editServicePriv,callback:function(t){e.editServicePriv=t},expression:"editServicePriv"}},[i("el-option",{attrs:{label:"normal",value:"normal"}}),e._v(" "),i("el-option",{attrs:{label:"admin",value:"admin"}})],1),e._v(" "),i("el-button",{staticClass:"button-new-tag",staticStyle:{border:"none"},attrs:{icon:"el-icon-plus"},on:{click:e.addServiceUser}}),e._v(" "),i("div",e._l(e.editServiceUsers,function(t){return i("el-tag",{key:t,attrs:{closable:"","disable-transitions":!1},on:{close:function(i){e.delServiceUser(t.username)}}},[e._v(e._s(t.username))])}))],1),e._v(" "),i("div",{staticClass:"form-block"},[i("el-tag",{staticStyle:{border:"none"},attrs:{type:"warning"}},[e._v("危险区域")]),e._v(" "),i("el-form-item",{staticClass:"margin-top-20",attrs:{label:"change owner"}},[i("el-select",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"select user",filterable:""},model:{value:e.tempEdit.owner,callback:function(t){e.$set(e.tempEdit,"owner",t)},expression:"tempEdit.owner"}},e._l(e.users,function(e){return i("el-option",{key:e.id,attrs:{label:e.username,value:e.username}})})),e._v(" "),i("el-alert",{attrs:{closable:!1,title:"Once the owner is changed to others, you will loose the control of this service",type:"warning"}})],1)],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.editServiceVisible=!1}}},[e._v("Cancel")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.editSubmit}},[e._v("Submit")])],1)],1)],1)},staticRenderFns:[]};var d=i("VU/8")(c,o,!1,function(e){i("Y8ip")},"data-v-5a4a1b97",null);t.default=d.exports},yqXf:function(e,t,i){(e.exports=i("FZ+f")(!1)).push([e.i,"\n.el-tag + .el-tag[data-v-5a4a1b97] {\n   margin-left: 10px;\n}\n.button-new-tag[data-v-5a4a1b97] {\n   /* margin-left: 10px; */\n   height: 32px;\n   line-height: 30px;\n   padding-top: 0;\n   padding-bottom: 0;\n}\n.input-new-tag[data-v-5a4a1b97] {\n   width: 120px;\n   /* margin-left: 10px; */\n   vertical-align: bottom;\n}\n",""])}});